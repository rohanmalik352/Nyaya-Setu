
<% layout('layouts/boilerplate') %>
<body>

  <div class="ns-amb"></div>
  <div class="ns-stars" id="starsContainer"></div>

  <div class="ns-page" style="padding: 2rem;">
    <header class="ns-hdr" style="max-width: 1200px; margin: 0 auto; width: 100%;">
      <div class="ns-logo-n">Evidence Repository</div>
      <a href="/" class="ns-sub"
        style="width: auto; text-decoration: none; padding: 0.5rem 1.5rem; display: inline-block;">+ Log New
        Evidence</a>
    </header>

    <div style="max-width: 1200px; margin: 0 auto; width: 100%;">
      <div class="ns-table-container">
        <table class="ns-table">
          <thead>
            <tr>
              <th>Case ID</th>
              <th>Officer ID</th>
              <th>File Name</th>
              <th>File Hash</th>
              <th>IPFS CID</th>
              <th>Blockchain Tx</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% evidences.forEach(e=> { %>
              <tr>
                <td><span class="ns-badge">
                    <%= e.caseId %>
                  </span></td>
                <td>
                  <%= e.officerId %>
                </td>
                <td>
                  <%= e.fileName %>
                </td>
                <td>
                  <span title="<%= e.fileHash %>" style="font-family: monospace; color: var(--txt2);">
                    <%= e.fileHash.substring(0, 12) %>...
                  </span>
                </td>
                <td>
                  <a href="https://ipfs.io/ipfs/<%= e.ipfsCID %>" target="_blank" class="ns-link">
                    View Data
                  </a>
                </td>
                <td>
                  <span title="<%= e.blockchainTxHash %>" style="font-family: monospace; color: var(--e4);">
                    <%= e.blockchainTxHash==='PENDING_SIGNATURE' ? 'PENDING' : e.blockchainTxHash.substring(0, 12)
                      + '...' %>
                  </span>
                </td>
                <td>
                  <div style="display: flex; flex-direction: column; gap: 5px;">
                    <a href="/verify?id=<%= e.id %>" class="ns-btn-sm"
                      style="text-decoration: none; text-align: center; border-color: var(--e4); color: var(--e4);">
                      üîç Verify
                    </a>
                    <a href="/evidence/retrieve/<%= e.id %>" class="ns-btn-sm"
                      style="text-decoration: none; text-align: center; border-color: #059669; color: #059669;">
                      ‚¨áÔ∏è Golden Copy
                    </a>
                  </div>
                </td>
              </tr>
              <% }) %>

                <% if(evidences.length===0) { %>
                  <tr>
                    <td colspan="7" style="text-align: center; padding: 3rem; color: var(--txt3);">
                      No evidence records found in the repository.
                    </td>
                  </tr>
                  <% } %>
          </tbody>
        </table>
      </div>
    </div>
  </div>

</body>

